<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sending alerts via syslog &#8212; OSSEC</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-3.2.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/parallax.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script src="../../../_static/js/jquery-fix.js"></script>
    <script src="../../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Sending alerts via E-Mail" href="email-output.html" />
    <link rel="prev" title="Output and Alert options" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-138780766-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-138780766-1');
</script>

<script type="text/javascript">
  var _ss = _ss || [];
  _ss.push(['_setDomain', 'https://koi-3QNN51VTHS.marketingautomation.services/net']);
  _ss.push(['_setAccount', 'KOI-4APYNOYP8O']);
  _ss.push(['_trackPageView']);
  window._pa = window._pa || {};
  // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
  // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
  // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
  (function() {
  var ss = document.createElement('script');
  ss.type = 'text/javascript'; ss.async = true;
  ss.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'koi-3QNN51VTHS.marketingautomation.services/client/ss.js?ver=2.4.0';
  var scr = document.getElementsByTagName('script')[0];
  scr.parentNode.insertBefore(ss, scr);
  })();
  </script>



  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html"><img src="../../../_static/ossec_logo_bare_small.png">
          OSSEC</a>
        <span class="navbar-text navbar-version pull-left"><b>3.6.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://www.ossec.net/about/">About</a></li>
                <li><a href="https://www.ossec.net/docs/">Documentation</a></li>
                <li><a href="https://www.ossec.net/register-for-ossec/">Get OSSEC+</a></li>
                <li><a href="https://www.ossec.net/downloads/">Downloads</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Manual</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cookbooks/index.html">User submitted Cookbooks</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../development/build/index.html">Build, compile, and not much more</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/oRFC/index.html">oRFC:</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../syntax/index.html">Syntax and Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../formats/index.html">Output Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../programs/index.html">Man pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Examples</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="index.html" title="Previous Chapter: Output and Alert options"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Output and Al...</span>
    </a>
  </li>
  <li>
    <a href="email-output.html" title="Next Chapter: Sending alerts via E-Mail"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Sending alert... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="sending-alerts-via-syslog">
<span id="manual-out-syslog"></span><h1>Sending alerts via syslog<a class="headerlink" href="#sending-alerts-via-syslog" title="Permalink to this headline">¶</a></h1>
<p>Syslog output allows an OSSEC manager to send the OSSEC alerts to one or more syslog servers.
Because OSSEC only sends the alerts via syslog, these options are for server or local installations only.</p>
<p>OSSEC also supports sending alerts via cef, json, and to Splunk.</p>
<div class="section" id="configuration-options">
<h2>Configuration options<a class="headerlink" href="#configuration-options" title="Permalink to this headline">¶</a></h2>
<p>These configurations options require a server or local installation.</p>
</div>
<div class="section" id="enabling-syslog-output">
<h2>Enabling Syslog output<a class="headerlink" href="#enabling-syslog-output" title="Permalink to this headline">¶</a></h2>
<p>An OSSEC server can be configured to send the alerts via syslog.
In this example all alerts are sent to 192.168.4.1, and alerts of level 10 and
above are also sent to 10.1.1.1:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ossec_config&gt;</span>
  ...

  <span class="nt">&lt;syslog_output&gt;</span>
    <span class="nt">&lt;server&gt;</span>192.168.4.1<span class="nt">&lt;/server&gt;</span>
  <span class="nt">&lt;/syslog_output&gt;</span>

  <span class="nt">&lt;syslog_output&gt;</span>
    <span class="nt">&lt;level&gt;</span>10<span class="nt">&lt;/level&gt;</span>
    <span class="nt">&lt;server&gt;</span>10.1.1.1<span class="nt">&lt;/server&gt;</span>
  <span class="nt">&lt;/syslog_output&gt;</span>

  ...
<span class="nt">&lt;/ossec_config&gt;</span>
</pre></div>
</div>
<p>After this change is made, the client-syslog process should be enabled:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>/var/ossec/bin/ossec-control <span class="nb">enable</span> client-syslog
</pre></div>
</div>
<p>And finally restart the OSSEC processes:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>/var/ossec/bin/ossec-control restart
</pre></div>
</div>
<p>ossec-csyslog should start along with the other OSSEC processes:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Starting OSSEC HIDS v2.8 (by Trend Micro Inc.)...</span>
<span class="go">...</span>
<span class="go">Started ossec-csyslogd...</span>
<span class="go">...</span>
</pre></div>
</div>
<p>And in the logs:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>tail -n <span class="m">1000</span> /var/ossec/logs/ossec.log <span class="p">|</span> grep csyslog
<span class="go">2008/07/25 12:55:16 ossec-csyslogd: INFO: Started (pid: 19412).</span>
<span class="go">2008/07/25 12:55:16 ossec-csyslogd: INFO: Forwarding alerts via syslog to: ‘192.168.4.1:514′.</span>
<span class="go">2008/07/25 12:55:16 ossec-csyslogd: INFO: Forwarding alerts via syslog to: ‘10.1.1.1:514′.</span>
</pre></div>
</div>
<p>Here is an example of what the listening syslog daemon should receive (every log separated by level,
rule, location and the actual event that generated it):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Jul 25 12:17:41 enigma ossec: Alert Level: 3; Rule: 5715 - SSHD authentication success.; Location: (jul) 192.168.2.0-&gt;/var/log/messages;</span>
<span class="go">srcip: 192.168.2.190; user: root; Jul 25 13:26:24 slacker sshd[20440]: Accepted password for root from 192.168.2.190 port 49737 ssh2</span>
</pre></div>
</div>
<div class="section" id="send-all-alerts-to-10-10-10-125">
<h3>Send all alerts to 10.10.10.125:<a class="headerlink" href="#send-all-alerts-to-10-10-10-125" title="Permalink to this headline">¶</a></h3>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;syslog_output&gt;</span>
  <span class="nt">&lt;server&gt;</span>10.10.10.125<span class="nt">&lt;/server&gt;</span>
<span class="nt">&lt;/syslog_output&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="send-all-alerts-to-10-10-10-126-in-cef">
<h3>Send all alerts to 10.10.10.126 in CEF:<a class="headerlink" href="#send-all-alerts-to-10-10-10-126-in-cef" title="Permalink to this headline">¶</a></h3>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;syslog_output&gt;</span>
  <span class="nt">&lt;server&gt;</span>10.10.10.126<span class="nt">&lt;/server&gt;</span>
  <span class="nt">&lt;format&gt;</span>cef<span class="nt">&lt;/format&gt;</span>
<span class="nt">&lt;/syslog_output&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="send-all-alerts-level-6-and-above-to-10-10-10-127-on-port-515">
<h3>Send all alerts level 6 and above to 10.10.10.127 on port 515:<a class="headerlink" href="#send-all-alerts-level-6-and-above-to-10-10-10-127-on-port-515" title="Permalink to this headline">¶</a></h3>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;syslog_output&gt;</span>
  <span class="nt">&lt;server&gt;</span>10.10.10.127<span class="nt">&lt;/server&gt;</span>
  <span class="nt">&lt;port&gt;</span>515<span class="nt">&lt;/port&gt;</span>
  <span class="nt">&lt;level&gt;</span>6<span class="nt">&lt;/level&gt;</span>
<span class="nt">&lt;/syslog_output&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2021, OSSEC Project Team.<br/>
    OSSEC <b>ossec.net</b> domain owned and maintained by <a href="https://www.ossec.net" target="_blank">OSSEC Foundation</a><br/>
    Home page graphics courtesy of <a href="https://pixabay.com" target="_blank">pixabay</a>
    </p>
  </div>
</footer>
  </body>
</html>