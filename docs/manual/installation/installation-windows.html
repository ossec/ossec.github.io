<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Windows Agent Installation &#8212; OSSEC</title>
    
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-3.2.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/parallax.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '3.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Package Installation" href="installation-package.html" />
    <link rel="prev" title="Manager/Agent Installation" href="install-source.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-inverse navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html"><img src="../../../_static/ossec_logo_bare_small.png">
          OSSEC</a>
        <span class="navbar-text navbar-version pull-left"><b>3.6.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://www.ossec.net/about/">About <i class="fa fa-info-circle"></i></a></li>
                <li><a href="https://www.ossec.net/docs/">Documentation <i class="fa fa-book"></i></a></li>
                <li><a href="https://www.ossec.net/downloads/">Downloads <i class="fa fa-download"></i></a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Manual</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cookbooks/index.html">User submitted Cookbooks</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../development/build/index.html">Build, compile, and not much more</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/oRFC/index.html">oRFC:</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../syntax/index.html">Syntax and Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../formats/index.html">Output Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../programs/index.html">Man pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Examples</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="install-source.html" title="Previous Chapter: Manager/Agent Installation"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Manager/Agent...</span>
    </a>
  </li>
  <li>
    <a href="installation-package.html" title="Next Chapter: Package Installation"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Package Installation &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="windows-agent-installation">
<span id="manual-win-install"></span><h1>Windows Agent Installation<a class="headerlink" href="#windows-agent-installation" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">OSSEC only supports Windows systems as agents, and they
will require an OSSEC server to function.</p>
</div>
<div class="section" id="step-1-opening-the-agent-manager-menu">
<h2>Step 1: Opening the Agent Manager menu<a class="headerlink" href="#step-1-opening-the-agent-manager-menu" title="Permalink to this headline">¶</a></h2>
<p>The first step of this process is to get into the Agent Manager menu. From the ossec server, type the following command:</p>
<p><cite>/var/ossec/bin/manage_agents</cite></p>
<p>The menu should look like this:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">****************************************</span>
<span class="go">* OSSEC HIDS v2.5-SNP-100809 Agent manager.*</span>
<span class="go">* The following options are available:*</span>
<span class="go">***************************************</span>

<span class="gp gp-VirtualEnv">(A)</span><span class="go">dd an agent (A).</span>
<span class="gp gp-VirtualEnv">(E)</span><span class="go">xtract key for an agent (E).</span>
<span class="gp gp-VirtualEnv">(L)</span><span class="go">ist already added agents (L).</span>
<span class="gp gp-VirtualEnv">(R)</span><span class="go">emove an agent (R).</span>
<span class="gp gp-VirtualEnv">(Q)</span><span class="go">uit.</span>
<span class="go">Choose your action: A,E,L,R or Q:</span>
</pre></div>
</div>
</div>
<div class="section" id="step-2-adding-an-agent">
<h2>Step 2: Adding an Agent<a class="headerlink" href="#step-2-adding-an-agent" title="Permalink to this headline">¶</a></h2>
<p>Adding an agent is the first thing that needs to be done. Choose action &#8220;A&#8221;.</p>
<p>The agent manager first asks for a name. This can be named anything.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Adding</span> <span class="n">a</span> <span class="n">new</span> <span class="n">agent</span> <span class="p">(</span><span class="n">use</span> <span class="s1">&#39;\q&#39;</span> <span class="n">to</span> <span class="k">return</span> <span class="n">to</span> <span class="n">the</span> <span class="n">main</span> <span class="n">menu</span><span class="p">)</span><span class="o">.</span>
<span class="n">Please</span> <span class="n">provide</span> <span class="n">the</span> <span class="n">following</span><span class="p">:</span>   <span class="o">*</span> <span class="n">A</span> <span class="n">name</span> <span class="k">for</span> <span class="n">the</span> <span class="n">new</span> <span class="n">agent</span><span class="p">:</span>
</pre></div>
</div>
<p>Next, it asks for the IP address of the windows client.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">IP</span> <span class="n">Address</span> <span class="n">of</span> <span class="n">the</span> <span class="n">new</span> <span class="n">agent</span><span class="p">:</span>
</pre></div>
</div>
<p>After that, it asks for a unique ID to assign to the client. The ID must be all numerical with a maximum of eight digits. The agent manager also suggests ID&#8217;s for new agents.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">An</span> <span class="n">ID</span> <span class="k">for</span> <span class="n">the</span> <span class="n">new</span> <span class="n">agent</span><span class="p">[</span><span class="mi">001</span><span class="p">]:</span>
</pre></div>
</div>
<p>Lastly, it asks for confirmation of all the information provided. Then it appends all of the agent information to /var/ossec/etc/client.keys and returns to the main menu.</p>
</div>
<div class="section" id="step-3-extracting-a-key">
<h2>Step 3: Extracting a Key<a class="headerlink" href="#step-3-extracting-a-key" title="Permalink to this headline">¶</a></h2>
<p>Now, the client key needs to be extracted. From the main menu, choose action &#8220;E&#8221;. A list of agents will be displayed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Available</span> <span class="n">agents</span><span class="p">:</span>   <span class="n">ID</span><span class="p">:</span> <span class="mi">001</span><span class="p">,</span> <span class="n">Name</span><span class="p">:</span> <span class="n">agent1</span><span class="p">,</span> <span class="n">IP</span><span class="p">:</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">50.2</span>
<span class="n">Provide</span> <span class="n">the</span> <span class="n">ID</span> <span class="n">of</span> <span class="n">the</span> <span class="n">agent</span> <span class="n">to</span> <span class="n">extract</span> <span class="n">the</span> <span class="n">key</span> <span class="p">(</span><span class="ow">or</span> <span class="s1">&#39;\q&#39;</span> <span class="n">to</span> <span class="n">quit</span><span class="p">):</span>
</pre></div>
</div>
<p>Enter the full ID of the agent to extract the key for. It will display the entire key. Copy that to the clipboard, for it will be needed later.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Agent</span> <span class="n">key</span> <span class="n">information</span> <span class="k">for</span> <span class="s1">&#39;001&#39;</span> <span class="ow">is</span><span class="p">:</span><span class="n">MDAyIGFnZW50MSAxOTIuMTY4LjIuMC8yNCBlNmY3N2RiMTdmMTJjZGRmZjg5YzA4ZDk5m</span>
</pre></div>
</div>
</div>
<div class="section" id="step-4-the-windows-side">
<h2>Step 4: The Windows Side<a class="headerlink" href="#step-4-the-windows-side" title="Permalink to this headline">¶</a></h2>
<p>Next up, download the executable named Agent Windows from <a class="reference external" href="https://ossec.github.io/downloads.html">https://ossec.github.io/downloads.html</a>. Run through the install wizard with all defaults. It should launch the Ossec Agent Manager when it&#8217;s done. The Ossec Agent Manager looks like this:</p>
<p><img alt="image0" src="https://github.com/Vendetta547/ossec-docs/blob/patch-1/OSSEC-Agent-Manager-Windows.png" /></p>
<p>Enter the IP address of your ossec server in the first text field, and enter the extracted key that was copied to the clipboard earlier to the second textfield. Finally, click on the manage tab and hit restart.</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2020, OSSEC Project Team.<br/>
    OSSEC <b>ossec.net</b> domain owned and maintained by <a href="https://www.ossec.net" target="_blank">OSSEC Foundation</a><br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.5.2 - 
    Home page graphics courtesy of <a href="https://pixabay.com" target="_blank">pixabay</a>
    </p>
  </div>
</footer>
  </body>
</html>