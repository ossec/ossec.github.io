<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ossec.conf: Syscheck Options &#8212; OSSEC</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.2.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/parallax.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script src="../../_static/js/jquery-fix.js"></script>
    <script src="../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ossec.conf: Syslog Output options" href="head_ossec_config.syslog_output.html" />
    <link rel="prev" title="ossec.conf: Rules options" href="head_ossec_config.rules.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-138780766-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-138780766-1');
</script>

<script type="text/javascript">
  var _ss = _ss || [];
  _ss.push(['_setDomain', 'https://koi-3QNN51VTHS.marketingautomation.services/net']);
  _ss.push(['_setAccount', 'KOI-4APYNOYP8O']);
  _ss.push(['_trackPageView']);
  window._pa = window._pa || {};
  // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
  // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
  // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
  (function() {
  var ss = document.createElement('script');
  ss.type = 'text/javascript'; ss.async = true;
  ss.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'koi-3QNN51VTHS.marketingautomation.services/client/ss.js?ver=2.4.0';
  var scr = document.getElementsByTagName('script')[0];
  scr.parentNode.insertBefore(ss, scr);
  })();
  </script>



  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><img src="../../_static/ossec_logo_bare_small.png">
          OSSEC</a>
        <span class="navbar-text navbar-version pull-left"><b>3.6.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://www.ossec.net/about/">About</a></li>
                <li><a href="https://www.ossec.net/docs/">Documentation</a></li>
                <li><a href="https://www.ossec.net/register-for-ossec/">Get OSSEC+</a></li>
                <li><a href="https://www.ossec.net/downloads/">Downloads</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../manual/index.html">Manual</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cookbooks/index.html">User submitted Cookbooks</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/build/index.html">Build, compile, and not much more</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/oRFC/index.html">oRFC:</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Syntax and Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../formats/index.html">Output Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programs/index.html">Man pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="head_ossec_config.rules.html" title="Previous Chapter: ossec.conf: Rules options"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; ossec.conf: R...</span>
    </a>
  </li>
  <li>
    <a href="head_ossec_config.syslog_output.html" title="Next Chapter: ossec.conf: Syslog Output options"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">ossec.conf: S... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="ossec-conf-syscheck-options">
<span id="ossec-config-syscheck"></span><h1>ossec.conf: Syscheck Options<a class="headerlink" href="#ossec-conf-syscheck-options" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<div class="section" id="supported-types">
<h3>Supported types<a class="headerlink" href="#supported-types" title="Permalink to this headline">¶</a></h3>
<p>Syscheck options are available in the the following installation types:</p>
<ul class="simple">
<li><p>server</p></li>
<li><p>local</p></li>
<li><p>agent</p></li>
</ul>
</div>
<div class="section" id="location">
<h3>Location<a class="headerlink" href="#location" title="Permalink to this headline">¶</a></h3>
<p>All global options must be configured in the /var/ossec/etc/ossec.conf
and used within the &lt;ossec_config&gt; tag.</p>
<p>XML excerpt to show location:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ossec_config&gt;</span>
    <span class="nt">&lt;syscheck&gt;</span>
        <span class="c">&lt;!--</span>
<span class="c">        Syscheck options here</span>
<span class="c">        --&gt;</span>
    <span class="nt">&lt;/syscheck&gt;</span>
<span class="nt">&lt;/ossec_config&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="options">
<h2>Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h2>
<dl class="object">
<dt>
<code class="sig-name descname"><span class="pre">directories</span></code></dt>
<dd><p>Use this option to add or remove directories to be monitored (they must be comma separated). All files and subdirectories will also be monitored.
Drive letters without directories are not valid. At a minimum the ‘.’ should be included (<code class="docutils literal notranslate"><span class="pre">D:\.</span></code>). This should be set on the system you wish to
monitor (or in the agent.conf if appropriate).</p>
<p><strong>Default:</strong> /etc,/usr/bin,/usr/sbin,/bin,/sbin</p>
<p><strong>Attributes:</strong></p>
<ul>
<li><p><strong>realtime</strong>: Value=yes</p>
<blockquote>
<div><ul class="simple">
<li><p>This will enable realtime/continuous monitoring on Linux (using the inotify system calls) and Windows systems.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>report_changes</strong>: Value=yes</p>
<blockquote>
<div><ul class="simple">
<li><p>Report diffs of file changes.  This is limited to text files at this time.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This option is only available on Unix-like systems.</p>
</div>
</div></blockquote>
</li>
<li><p><strong>check_all</strong>: Value=yes</p>
<blockquote>
<div><ul class="simple">
<li><p>All the following check_* options are used together unless a specific option is explicitly overridden with “no”.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>check_sum</strong>: Value=yes</p>
<blockquote>
<div><ul>
<li><p>Check the md5 and sha1 hashes of the  of the files will be checked.</p>
<p>This is the same as using both check_sha1sum=”yes” and check_md5sum=”yes”</p>
</li>
</ul>
</div></blockquote>
</li>
<li><p><strong>check_sha1sum</strong>: Value=yes</p>
<blockquote>
<div><ul class="simple">
<li><p>When used only the sha1 hash of the files will be checked.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>check_md5sum</strong>: Value=yes</p>
<blockquote>
<div><ul class="simple">
<li><p>The md5 hash of the files will be checked.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>check_size</strong>: Value=yes</p>
<blockquote>
<div><ul class="simple">
<li><p>The size of the files will be checked.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>check_owner</strong>: Value=yes</p>
<blockquote>
<div><ul class="simple">
<li><p>Check the owner of the files selected.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>check_group</strong>: Value=yes</p>
<blockquote>
<div><ul class="simple">
<li><p>Check the group owner of the files/directories selected.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>check_perm</strong>: Value=yes</p>
<blockquote>
<div><ul class="simple">
<li><p>Check the UNIX permission of the files/directories selected.
On windows this will only check the POSIX permissions.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>restrict</strong>: Value=string</p>
<blockquote>
<div><ul class="simple">
<li><p>A string that will limit checks to files containing that string in the file name.</p></li>
</ul>
<p><strong>Allowed:</strong> Any directory or file name (but not a path)</p>
</div></blockquote>
</li>
<li><p><strong>no_recurse</strong>: Value=no</p>
<blockquote>
<div><div class="versionadded">
<p><span class="versionmodified added">New in version 3.2.</span></p>
</div>
<ul class="simple">
<li><p>Do not recurse into the defined directory.</p></li>
</ul>
<p><strong>Allowed:</strong> yes/no</p>
</div></blockquote>
</li>
</ul>
</dd></dl>

<dl class="object">
<dt>
<code class="sig-name descname"><span class="pre">ignore</span></code></dt>
<dd><p>List of files or directories to be ignored (one entry per element). The files and directories are still checked, but the results are ignored.</p>
<p><strong>Default:</strong> /etc/mtab</p>
<p><strong>Attributes:</strong></p>
<ul>
<li><p><strong>type</strong>: Value=sregex</p>
<blockquote>
<div><ul class="simple">
<li><p>This is a simple regex pattern to filter out files so alerts are not generated.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p><strong>Allowed:</strong> Any directory or file name</p>
</dd></dl>

<dl class="object">
<dt>
<code class="sig-name descname"><span class="pre">nodiff</span></code></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 3.0.</span></p>
</div>
<p>List of files to not attach a diff. The files are still checked, but no diff is computed. This allows to monitor sensitive files like private key or database configuration without leaking sensitive data through alerts.</p>
<p><strong>Attributes:</strong></p>
<ul>
<li><p><strong>type</strong>: Value=sregex</p>
<blockquote>
<div><ul class="simple">
<li><p>This is a simple regex pattern to filter out files so alerts are not generated.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p><strong>Allowed:</strong> Any directory or file name</p>
</dd></dl>

<dl class="object">
<dt>
<code class="sig-name descname"><span class="pre">frequency</span></code></dt>
<dd><p>Frequency that the syscheck is going to be executed (in seconds).</p>
<p>The default is 6 hours or 21600 seconds</p>
<p><strong>Default:</strong> 21600</p>
<p><strong>Allowed:</strong> Time in seconds</p>
</dd></dl>

<dl class="object">
<dt>
<code class="sig-name descname"><span class="pre">scan_time</span></code></dt>
<dd><p>Time to run the scans (can be in the formats of 21pm, 8:30, 12am, etc).</p>
<p><strong>Allowed:</strong> Time to run scan</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This may delay the initialization of realtime scans.</p>
</div>
</dd></dl>

<dl class="object">
<dt>
<code class="sig-name descname"><span class="pre">scan_day</span></code></dt>
<dd><p>Day of the week to run the scans (can be in the format of sunday, saturday, monday, etc)</p>
<p><strong>Allowed:</strong> Day of the week</p>
</dd></dl>

<span class="target" id="auto-ignore"></span><dl class="object">
<dt>
<code class="sig-name descname"><span class="pre">auto_ignore</span></code></dt>
<dd><p>Specifies if syscheck will ignore files that change too often (after the third change)</p>
<p><strong>Default:</strong> yes</p>
<p><strong>Allowed:</strong> yes/no</p>
<p><strong>Valid:</strong> server, local</p>
</dd></dl>

<span class="target" id="alert-new-files"></span><dl class="object">
<dt>
<code class="sig-name descname"><span class="pre">alert_new_files</span></code></dt>
<dd><p>Specifies if syscheck should alert on new files created.</p>
<p><strong>Default:</strong> no</p>
<p><strong>Allowed:</strong> yes/no</p>
<p><strong>Valid:</strong> server, local</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>New files will only be detected on a full scan, this option does not work in realtime.</p>
</div>
</dd></dl>

<dl class="object">
<dt>
<code class="sig-name descname"><span class="pre">scan_on_start</span></code></dt>
<dd><p>Specifies if syscheck should do the first scan as soon as it is started.</p>
<p><strong>Default:</strong> yes</p>
<p><strong>Allowed:</strong> yes/no</p>
</dd></dl>

<dl class="object">
<dt>
<code class="sig-name descname"><span class="pre">windows_registry</span></code></dt>
<dd><p>Use this option to add Windows registry entries to be monitored (Windows-only).</p>
<p><strong>Default:</strong> HKEY_LOCAL_MACHINESoftware</p>
<p><strong>Allowed:</strong> Any registry entry (one per element)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>New entries will not trigger alerts, only changes to existing entries.</p>
</div>
</dd></dl>

<dl class="object">
<dt>
<code class="sig-name descname"><span class="pre">registry_ignore</span></code></dt>
<dd><p>List of registry entries to be ignored.</p>
<p><strong>Default:</strong> ..CryptographyRNG</p>
<p><strong>Allowed:</strong> Any registry entry (one per element)</p>
</dd></dl>

<dl class="object">
<dt>
<code class="sig-name descname"><span class="pre">prefilter_cmd</span></code></dt>
<dd><p>Command to run to prevent prelinking from creating false positives.</p>
<p><strong>Example:</strong></p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;prefilter_cmd&gt;</span>/usr/sbin/prelink -y<span class="nt">&lt;/prefilter_cmd&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This option can potentially impact performance negatively. The configured command will be run for each and every file checked.</p>
</div>
</dd></dl>

<dl class="object">
<dt>
<code class="sig-name descname"><span class="pre">skip_nfs</span></code></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 2.9.0.</span></p>
</div>
<p>Specifies if syscheck should scan network mounted filesystems.  Works on Linux and FreeBSD.  Currently skip_nfs will abort checks running against CIFS or NFS mounts.</p>
<p><strong>Default:</strong> no</p>
<p><strong>Allowed:</strong> yes/no</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This option was added in OSSEC 2.9.</p>
</div>
</dd></dl>

</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2021, OSSEC Project Team.<br/>
    OSSEC <b>ossec.net</b> domain owned and maintained by <a href="https://www.ossec.net" target="_blank">OSSEC Foundation</a><br/>
    Home page graphics courtesy of <a href="https://pixabay.com" target="_blank">pixabay</a>
    </p>
  </div>
</footer>
  </body>
</html>